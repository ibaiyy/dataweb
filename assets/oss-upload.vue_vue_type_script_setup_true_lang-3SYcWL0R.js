import{a as j,g as B}from"./index-DVgET6nB.js";import{d as C,a,r as l,o as b,c as H,B as t,A as p,h as d,H as u}from"./vlib-DOiUgBZ7.js";const L=d("div",{class:"el-upload__text"},"将文件拖到此处，或点击上传",-1),D=d("div",{class:"el-upload__tip"},"只支持jpg、png、gif格式文件！",-1),w=C({__name:"oss-upload",emits:["refreshDataList"],setup(N,{expose:_,emit:m}){const f=m,o=a(!1),r=a(""),s=a(0),n=a(),g=()=>{o.value=!0,r.value=`${j.api}/sys/oss/upload?token=${B()}`,s.value=0,n.value=[]},v=e=>{if(e.type!=="image/jpg"&&e.type!=="image/jpeg"&&e.type!=="image/png"&&e.type!=="image/gif")return u.error("只支持jpg、png、gif格式文件！"),!1;s.value++},x=(e,i,c)=>{if(e.code!==0)return u.error(e.msg);n.value=c,s.value--,s.value===0&&u.success({message:"成功",duration:500,onClose:()=>{o.value=!1,f("refreshDataList")}})};return _({init:g}),(e,i)=>{const c=l("upload-filled"),h=l("el-icon"),k=l("el-upload"),y=l("el-dialog");return b(),H(y,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=V=>o.value=V),title:"上传文件","close-on-click-modal":!1,"close-on-press-escape":!1},{default:t(()=>[p(k,{action:r.value,"file-list":n.value,drag:"",multiple:"","before-upload":v,"on-success":x,class:"text-center"},{tip:t(()=>[D]),default:t(()=>[p(h,{class:"el-icon--upload"},{default:t(()=>[p(c)]),_:1}),L]),_:1},8,["action","file-list"])]),_:1},8,["modelValue"])}}});export{w as _};
